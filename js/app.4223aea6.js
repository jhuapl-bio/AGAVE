(function(t){function e(e){for(var n,s,o=e[0],l=e[1],c=e[2],p=0,h=[];p<o.length;p++)s=o[p],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&h.push(i[s][0]),i[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);u&&u(e);while(h.length)h.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],n=!0,o=1;o<a.length;o++){var l=a[o];0!==i[l]&&(n=!1)}n&&(r.splice(e--,1),t=s(s.s=a[0]))}return t}var n={},i={app:0},r=[];function s(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=n,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(a,n,function(e){return t[e]}.bind(null,n));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/AGAVE/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var u=l;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("cd49")},"0409":function(t,e,a){},"29c5":function(t,e,a){},3736:function(t,e,a){},"58c9":function(t,e,a){"use strict";a("3736")},"6f09":function(t,e,a){"use strict";a("a5d7")},"8ca8":function(t,e,a){},"9f6b":function(t,e,a){"use strict";a("29c5")},a5d7:function(t,e,a){},bb35:function(t,e,a){},bfd8:function(t,e,a){t.exports=a.p+"img/apl.logo.large.horizontal.white.de45b0ff.svg"},cd49:function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("NavigationBar"),a("div",{staticClass:"router-outer "},[a("div",{staticClass:"router-inner columns pt-4",staticStyle:{padding:"0px",margin:"0px"}},[a("div",{staticClass:"column is-offset-1-mobile add-padding"},[a("DataView")],1)])]),t._m(0)],1)},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("footer",{staticClass:"footer"},[a("div",{staticClass:"content has-text-centered"},[t._v(" The work of JHU, JHU/APL, and BARDA. ")])])}],s=a("d4ec"),o=a("262e"),l=a("2caf"),c=a("9ab4"),u=a("60a3"),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-navbar",{staticClass:"navbar is-aplblue",staticStyle:{color:"white"},attrs:{centered:"",role:"navigation","aria-label":"main navigation"}},[n("div",{staticClass:"navbar-menu",attrs:{id:"navbarBasicExample"}},[n("h1",{staticClass:"navbar-item is-size-3",staticStyle:{"min-width":"25%","max-width":"50%"}},[t._l(t.name,(function(e){return n("span",{key:e,staticStyle:{color:"#fff",cursor:"default"},on:{mouseover:function(e){t.showTitleFull=!0},mouseleave:function(e){t.showTitleFull=!1}}},[t._v(" "+t._s(e.substring(0,1))+" ")])})),n("transition",{attrs:{name:"slide-fade"}},[t.showTitleFull?n("div",{staticStyle:{display:"flex"}},[n("div",t._l(t.name,(function(e){return n("span",{key:e,staticStyle:{color:"#fff"}},[n("small",{staticStyle:{"font-size":"14px"}},[t._v(t._s(e)+" ")])])})),0)]):t._e()])],2),n("div",{staticClass:"navbar-start"},[n("a",{staticClass:"navbar-item force-center",attrs:{id:"logo",href:"https://jhu.edu"}},[n("img",{staticClass:"navbar-image",attrs:{src:a("bfd8")}})])]),n("div",{staticClass:"navbar-end",staticStyle:{"min-width":"25%","max-width":"50%"}},[n("a",{staticClass:"navbar-item",staticStyle:{opacity:"0.0"}},[t._v(" About ")])])])])},h=[],d=(a("b0c0"),function(t){Object(o["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(s["a"])(this,a),t=e.apply(this,arguments),t.showMenu=!1,t.showTitleFull=!1,t.name=["Automated","Genomics","Application for","Variant","Exploration"],t}return a}(u["c"]));d=Object(c["a"])([Object(u["a"])({})],d);var f=d,m=f,g=(a("6f09"),a("2877")),b=Object(g["a"])(m,p,h,!1,null,"31c68025",null),v=b.exports,y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Visualization")],1)},_=[],x=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-row",{staticStyle:{overflow:"auto"}},[a("b-col",{attrs:{lg:"12"}},[a("h3",{staticClass:"title"},[t._v("Settings")]),a("VisualizationOptions",{attrs:{column_width:t.column_width,amino_acid_label_option:t.amino_acid_label_option,axis_label_option:t.axis_label_option},on:{sliderUpdate:t.sliderUpdate}})],1),a("div",{staticClass:"col-lg-12"},[a("hr",{staticClass:"solid"})]),a("div",{staticClass:"col-lg-12"},[a("h3",{staticClass:"title"},[t._v("Heatmap Viewer")]),a("h5",{staticClass:"subtitle"},[t._v("Click a column in the heatmap to zoom in on its molecular position")])]),t.DataHandler.cells&&t.DataHandler.cells.length>=0?a("div",{staticClass:"col-lg-8 pr-5"},[a("Heatmap",{ref:"heatmap",attrs:{column_width:t.column_width,DataHandler:t.DataHandler,amino_acid_label_option:t.amino_acid_label_option,axis_label_option:t.axis_label_option},on:{"update:column_width":function(e){t.column_width=e},"update:amino_acid_label_option":function(e){t.amino_acid_label_option=e},"update:axis_label_option":function(e){t.axis_label_option=e},changePosition:t.changePosition,changePdb:t.changePdb}}),a("div",{staticClass:"col-lg-12"},[a("hr",{staticClass:"solid"})]),a("div",{staticClass:"pt-4"},[a("h3",{staticClass:"title"},[t._v("Stacked Bar Chart")]),a("h5",{staticClass:"subtitle"},[t._v("Click a column in the heatmap to visualize its diversity")]),t.DataHandler.cells?a("BarPlot",{ref:"barplot",attrs:{DataHandler:t.DataHandler}}):t._e()],1)],1):t._e(),a("b-col",{staticClass:"col-lg-4 pb-1"},[a("MoleculeViewer",{attrs:{pdb:t.pdb,position:t.position,DataHandler:t.DataHandler},on:{siteHover:t.siteHover,changeReferenceSequence:t.changeReferenceSequence}})],1),a("canvas",{attrs:{id:"mycanvas"}})],1)},w=[],k=a("bee2"),O=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("b-tabs",[a("b-tab",{attrs:{title:"Data Settings",active:""}},[a("b-row",[a("b-col",{attrs:{sm:"2"}},[a("b-field",{staticClass:"column is-narrow",attrs:{label:"File"}},[t.DataHandler.defaultDataListFiles?a("b-select",{attrs:{placeholder:"File",options:t.DataHandler.defaultDataListFiles},on:{change:function(e){return t.emitChange(e,{full:!0,target:"file"})}},model:{value:t.DataHandler.defaultDataListFile,callback:function(e){t.$set(t.DataHandler,"defaultDataListFile",e)},expression:"DataHandler.defaultDataListFile"}}):t._e()],1),a("b-field",{staticClass:"column is-narrow ",staticStyle:{display:"flex"},attrs:{label:"Show Discordants Only"}},[a("b-checkbox",{staticClass:" ml-5",on:{change:function(e){return t.emitChange(e,{full:!0,target:"discordant"})}},model:{value:t.showDiscordantOnly,callback:function(e){t.showDiscordantOnly=e},expression:"showDiscordantOnly"}})],1)],1),a("b-col",{attrs:{sm:"2"}},[a("b-field",{staticClass:"column is-narrow",attrs:{label:t.isDataSwitched?"Default Data":"Custom"}},[a("b-select",{attrs:{placeholder:"Data"},on:{change:function(e){return t.emitChange(e,{full:!0,target:"data_selected"})}},model:{value:t.DataHandler.experiment,callback:function(e){t.$set(t.DataHandler,"experiment",e)},expression:"DataHandler.experiment"}},t._l(t.DataHandler.experiments,(function(e){return a("option",{key:e.id,domProps:{value:e}},[t._v(" "+t._s(e.label)+" ")])})),0)],1)],1),a("b-col",{attrs:{sm:"2"}},[a("b-field",{staticClass:"column is-narrow",attrs:{label:"Protein"}},[a("b-select",{attrs:{placeholder:"protein",options:t.DataHandler.proteins},on:{change:function(e){return t.emitChange(e,{full:!0,target:"protein"})}},model:{value:t.DataHandler.protein,callback:function(e){t.$set(t.DataHandler,"protein",e)},expression:"DataHandler.protein"}})],1)],1),a("b-col",{attrs:{sm:"2"}},[a("b-field",{staticClass:"column is-narrow",attrs:{label:"Sample"}},[t.DataHandler.sample?a("b-select",{attrs:{placeholder:"Sample",disabled:t.DataHandler.changing,multiple:"",options:t.DataHandler.samples},on:{change:function(e){return t.emitChange(e,{full:!0,target:"sample"})}},model:{value:t.DataHandler.sample,callback:function(e){t.$set(t.DataHandler,"sample",e)},expression:"DataHandler.sample"}}):t._e()],1)],1),a("b-col",{attrs:{sm:"2"}},[a("b-field",{staticClass:"column is-narrow",attrs:{label:"Group"}},[t.DataHandler.group?a("b-select",{attrs:{placeholder:"Group",disabled:t.DataHandler.changing,multiple:"",options:t.DataHandler.groups},on:{change:function(e){return t.emitChange(e,{full:!0,target:"group"})}},model:{value:t.DataHandler.group,callback:function(e){t.$set(t.DataHandler,"group",e)},expression:"DataHandler.group"}}):t._e()],1)],1),a("b-col",{attrs:{sm:"2"}},[a("b-field",{staticClass:"column is-narrow",attrs:{label:"Organism"}},[t.DataHandler.organism?a("b-select",{attrs:{placeholder:"Organism",disabled:t.DataHandler.changing,multiple:"",options:t.DataHandler.organisms},on:{change:function(e){return t.emitChange(e,{full:!0,target:"organism"})}},model:{value:t.DataHandler.organism,callback:function(e){t.$set(t.DataHandler,"organism",e)},expression:"DataHandler.organism"}}):t._e()],1)],1)],1)],1),a("b-tab",{attrs:{title:"Heatmap Settings"}},[a("div",{staticClass:"columns is-variable is-4"},[a("b-field",{staticClass:"column is-narrow",attrs:{label:"Depth Threshold"}},[a("b-numberinput",{attrs:{step:1,min:0,max:1e5,"controls-position":"compact"},model:{value:t.depth_threshold,callback:function(e){t.depth_threshold=e},expression:"depth_threshold"}})],1),a("b-field",{staticClass:"column is-narrow",attrs:{label:"Column Width"}},[a("b-numberinput",{attrs:{value:t.column_width,step:1,min:1,max:1e5,"controls-position":"compact"},on:{input:function(e){return t.onColWidthChanged(e)}}})],1),a("b-field",{staticClass:"column is-2",attrs:{label:"Position Ranges"}},[a("b-slider",{attrs:{y:"",min:1,max:t.DataHandler.position_max,step:1,ticks:""},on:{change:function(e){return t.emitChange(e,{full:!1,target:"position_ranges"})}},model:{value:t.DataHandler.position_ranges,callback:function(e){t.$set(t.DataHandler,"position_ranges",e)},expression:"DataHandler.position_ranges"}})],1),a("b-field",{staticClass:"column is-narrow",attrs:{label:"Cell Labels"}},[a("b-select",{attrs:{value:t.amino_acid_label_option},on:{input:function(e){return t.onAminoAcidLabelChanged(e)}}},t._l(t.amino_acid_label_options,(function(e){return a("option",{key:e,domProps:{value:e}},[t._v(" "+t._s(e)+" ")])})),0)],1),a("b-field",{staticClass:"column is-narrow",attrs:{label:"Axis Labels"}},[a("b-select",{attrs:{value:t.axis_label_option},on:{input:function(e){return t.onAxisLabelChanged(e)}}},t._l(t.amino_acid_label_options,(function(e){return a("option",{key:e,attrs:{disabled:t.DataHandler.organism.length>1&&"None"!==e},domProps:{value:e}},[t._v(" "+t._s(e)+" ")])})),0)],1)],1)]),a("b-tab",{attrs:{title:"Data Upload"}},[a("div",{staticClass:"columns is-variable is-4"},[a("b-field",{staticClass:"column is-6",attrs:{label:"Custom Variant File Input"}},[a("b-form-file",{ref:"customfile",attrs:{type:"file",id:"customfile",placeholder:"Choose a file or drop it here...","drop-placeholder":"Drop file here..."},model:{value:t.customfile,callback:function(e){t.customfile=e},expression:"customfile"}})],1)],1)])],1)],1)},D=[],H=a("1da1"),j=(a("96cf"),a("2909")),C=a("3835"),S=(a("4e82"),a("4de4"),a("d3b7"),a("caad"),a("2532"),a("159b"),a("d81d"),a("b680"),a("b64b"),a("4fad"),a("99af"),a("ddb0"),a("6062"),a("3ca3"),a("5698")),A=(a("fb6a"),function(){function t(){Object(s["a"])(this,t)}return Object(k["a"])(t,[{key:"parseJSON",value:function(t){return JSON.parse(t)}},{key:"readTSV",value:function(){var t=Object(H["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,S["v"]("".concat("/AGAVE/","data/").concat(e));case 2:return a=t.sent,t.abrupt("return",a.slice(0,2));case 4:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"readJSON",value:function(t){return new Promise((function(e,a){S["g"]("".concat("/AGAVE/").concat(t)).then((function(t){e(t)})).catch((function(t){console.log("error"),a(t)}))}))}},{key:"readTSVNoHeader",value:function(){var t=Object(H["a"])(regeneratorRuntime.mark((function t(e,a){var n,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,S["u"]("/data/".concat(e));case 2:return n=t.sent,i=S["w"](n),r=i.map((function(t){return a.reduce((function(e,a,n){return e[a]=t[n],e}),{})})),t.abrupt("return",r);case 6:case"end":return t.stop()}}),t)})));function e(e,a){return t.apply(this,arguments)}return e}()}]),t}()),P=a("df7c"),L=function(){function t(){Object(s["a"])(this,t),this.sort=!0,this.referenceSequence={},this.position_ranges=[],this.xvalues=[],this.pdb=null,this.isDefault=!0,this.selected_data=null,this.custom_data_last=null,this.selectedPosition=1,this.yvalues=[],this.cells=null,this.cells_full=null,this.raw_data=null,this.groups=[],this.group=[],this.samples=[],this.sample=[],this.protein=null,this.proteins=[],this.protein_map={},this.organism=[],this.organisms=[],this.experiments=[],this.isSwitched=!0,this.experiment=null,this.discordantOnly=!0,this.frequency_threshold=0,this.depth_threshold=0,this.localDataHelper=new A,this.position_max=1,this.position_min=1,this.consensus_map=null,this.pdb_map={},this.selected_consensus=null,this.changing=!1,this.defaultDataListFile=P["join"]("data","SecondExampleInputVariantsIVAR.json"),this.defaultDataListFiles=[P["join"]("data","SecondExampleInputVariantsIVAR.json"),P["join"]("data","default.json"),P["join"]("data","BARDA_New.json"),P["join"]("data","Gaydos.json")],this.data_selected=null,this.data_selected=this.defaultDataListFile}return Object(k["a"])(t,[{key:"updateReference",value:function(t){this.referenceSequence=t}},{key:"updatePositions",value:function(t){this.position_ranges=t}},{key:"updateGroup",value:function(t){this.groups=t}},{key:"updateProtein",value:function(t){this.protein=t}},{key:"changeExperiment",value:function(t){this.experiment=t}},{key:"changeDataType",value:function(t){this.isDefault=t,t||(this.selected_data=this.custom_data_last[0])}},{key:"updateOrganism",value:function(t){this.organism=t}},{key:"updateCells",value:function(){var t=this,e=this.cells_full.filter((function(e){return e.position>=t.position_ranges[0]&&e.position<=t.position_ranges[1]&&t.organism.includes(e.organism)&&t.protein==e.protein}));this.discordantOnly&&(e=e.filter((function(e){return t.referenceSequence&&e.position in t.referenceSequence?e.pdb_aa="".concat(t.referenceSequence[e.position]):e.pdb_aa="Unmapped",t.isSwitched?e.aa!==e.pdb_aa||e.count>1||1==e.count&&e.depth>0:e.aa!==e.consensus_aa||e.count>1||1==e.count&&e.depth>0}))),this.cells=e}},{key:"fullUpdate",value:function(){this.updateData(),this.updateCells()}},{key:"updateData",value:function(){var t=this,e=this;this.changing=!0;var a=this.filter();if(0!==a.length){var n=[],i={};a.forEach((function(t){i[t.gene]={},t.residues.forEach((function(e){i[t.gene][+e.position]=1}))})),a.forEach((function(a){var r={},s={},o=a.depths,l=a.organism;e.pdb_map[l]||(e.pdb_map[l]={}),a.residues.forEach((function(t){var i=0;r[t.position]=0,s[t.position]=1;a.pdb&&(e.pdb_map[l][a.gene]=a.pdb),n.push({unique:t.counts.map((function(e){return t.reference_aa==e.aa&&(i=e.count),{aa:e.aa,proportion:(e.count/+t.depth).toFixed(3)}})),protein:a.gene,max:Math.max(i,t.consensus_aa_count),organism:a.organism,group:a.group,experiment:a.sample,depth:t.depth,position:+t.position,total:+t.depth,count:t.counts.length,aa:t.reference_aa,aa_count:i,consensus_aa:t.consensus_aa,consensus_count:t.consensus_aa_count,pdb:a.pdb,yAxisLabel:a.yAxisLabel})}));var c=o.map((function(t,e){return e+1}));t.discordantOnly&&(c=i),Object.keys(c).forEach((function(i){if(!s[i]){var r=i-1,c=e.protein_map[l][a.gene],u=o[r];if(u>0){var p=c[r];n.push({unique:[{aa:p,proportion:1}],protein:a.gene,max:u,organism:a.organism,group:a.group,experiment:a.sample,depth:u,position:r+1,total:+u,count:1,aa:p,aa_count:u,consensus_aa:p,consensus_count:u,pdb:t.pdb_map[l][a.gene],yAxisLabel:a.yAxisLabel})}}}))}));var r=S["i"](n.map((function(t){return+t.position}))),s=S["h"](n.map((function(t){return+t.position})));this.position_max=s,this.position_min=r,this.position_ranges=[1,this.protein_map[this.organism[0]][this.protein].length],this.organism[0]in this.pdb_map&&this.protein in this.pdb_map[this.organism[0]]?this.pdb=this.pdb_map[this.organism[0]][this.protein]:this.pdb=null,this.cells_full=n,this.changing=!1}}},{key:"parseGroups",value:function(t,e){var a;if(t&&0!=t.length){var n=[];t.forEach((function(a){e.indexOf(t)<=-1&&n.push(a)})),a=0==n.length?n[0]:n}else a=[e[0]];return a}},{key:"filter",value:function(){for(var t=this,e=t.selected_data,a=Object.entries(e.proteins),n=0,i=a;n<i.length;n++){var r=Object(C["a"])(i[n],2),s=r[0],o=r[1];Object.entries(o);s in t.protein_map||(t.protein_map[s]={});for(var l=Object.entries(o),c=0,u=l;c<u.length;c++){var p=Object(C["a"])(u[c],2),h=p[0],d=p[1];t.protein_map[s][h]=d}}var f=[].concat.apply([],e.entries.map((function(t){return t.items.map((function(e){return e.experiment=t.experiment,e.group=t.group,e.sample=t.sample,e.yAxisLabel="".concat(e.organism,"\t").concat(t.sample),e}))})));return t.proteins=Object(j["a"])(new Set(f.map((function(t){return t.gene})))),t.protein&&-1!=t.proteins.indexOf(t.protein)||(t.protein=t.proteins[0]),f=[].concat.apply([],f.filter((function(e){return e.gene==t.protein}))),t.organisms=Object(j["a"])(new Set(f.map((function(t){return t.organism})))),t.organism&&0!==t.organism.length||(t.organism=t.organisms),t.samples=Object(j["a"])(new Set(f.map((function(t){return t.sample})))),t.groups=Object(j["a"])(new Set(f.map((function(t){return t.group})))),this.sample&&0!==this.sample.length||(this.sample=this.samples),t.organism&&0!==t.organisms.length||t.protein in t.protein_map[t.organism[0]]||t.organisms.forEach((function(e){t.protein in t.protein_map[e]&&t.organism.push(e)})),this.group&&0!=this.group.length||(this.group=this.groups),f=f.filter((function(e){return t.group.indexOf(e.group)>-1&&t.organism.includes(e.organism)&&t.sample.indexOf(e.sample)>-1})),f.sort((function(t,e){return t.yAxisLabel>e.yAxisLabel?1:e.yAxisLabel>t.yAxisLabel?-1:0})),f}},{key:"getData",value:function(){var t=Object(H["a"])(regeneratorRuntime.mark((function t(e,a){var n,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=function(t){n.experiments=t.map((function(t,e){return{id:e,label:t.name}})),n.experiment&&-1!=n.experiments.indexOf(n.experiment)||(n.experiment=n.experiments[0]),n.raw_data=t,n.isDefault||(n.custom_data_last=t),n.selected_data=t[0]},n=this,i=null,e=P["join"](e),t.prev=4,"file"!=a){t.next=14;break}return t.next=8,n.localDataHelper.readJSON(e);case 8:return i=t.sent,r(i),n.filter(),t.abrupt("return");case 14:return i=n.localDataHelper.parseJSON(e),r(i),n.filter(),t.abrupt("return");case 18:t.next=24;break;case 20:throw t.prev=20,t.t0=t["catch"](4),this.raw_data=[],t.t0;case 24:case"end":return t.stop()}}),t,this,[[4,20]])})));function e(e,a){return t.apply(this,arguments)}return e}()}]),t}(),R=function(t){Object(o["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(s["a"])(this,a),t=e.apply(this,arguments),t.depth_threshold=0,t.frequency_threshold=.2,t.data=null,t.cells=null,t.customfile=null,t.showDiscordantOnly=!0,t.isDataSwitched=!0,t.minrange=1,t.maxrange=1,t.position_max=1,t.position_ranges=[t.minrange,t.maxrange],t.fetching_information=!1,t.DataHandler=new L,t.amino_acid_label_options=["None","Consensus amino acids","Reference amino acids"],t.activeTab=0,t}return Object(k["a"])(a,[{key:"onSwitchedChangeDataType",value:function(t,e){this.emitChange(t,{full:!0,target:"data_type_selected"})}},{key:"onChangeFile",value:function(){var t=Object(H["a"])(regeneratorRuntime.mark((function t(e,a){var n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=this,i=new FileReader,this.isDataSwitched=!1,null,i.onload=function(t){n.getData(i.result,"string").then((function(t){n.$emit("sliderUpdate",{value:n.DataHandler,target:"DataHandler"})}))},i.onerror=function(t){n.$swal.fire({position:"center",icon:"error",showConfirmButton:!0,title:"Error in submitting file",text:t})},i.readAsText(e);case 7:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}()},{key:"onColWidthChanged",value:function(t){this.$emit("sliderUpdate",{value:t,target:"column_width"})}},{key:"onAminoAcidLabelChanged",value:function(t){this.$emit("sliderUpdate",{value:t,target:"amino_acid_label_option"})}},{key:"onAxisLabelChanged",value:function(t){this.$emit("sliderUpdate",{value:t,target:"axis_label_option"})}},{key:"onDepthTChanged",value:function(t,e){this.emitChange(t,{full:!1,target:"depth_threshold"})}},{key:"emitChange",value:function(){var t=Object(H["a"])(regeneratorRuntime.mark((function t(e,a){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=!0,"depth_threshold"!=a.target){t.next=5;break}this.DataHandler.depth_threshold=e,t.next=47;break;case 5:if("protein"!=a.target){t.next=9;break}this.DataHandler.updateProtein(e),t.next=47;break;case 9:if("organism"!=a.target){t.next=13;break}this.DataHandler.updateOrganism(e),t.next=47;break;case 13:if("data_type_selected"!=a.target){t.next=16;break}t.next=47;break;case 16:if("data_selected"!=a.target){t.next=20;break}this.DataHandler.changeExperiment(e),t.next=47;break;case 20:if("group"!=a.target){t.next=24;break}this.DataHandler.group=e,t.next=47;break;case 24:if("position_ranges"!=a.target){t.next=28;break}this.DataHandler.position_ranges=e,t.next=47;break;case 28:if("sample"!=a.target){t.next=32;break}this.DataHandler.sample=e,t.next=47;break;case 32:if("file"!=a.target){t.next=38;break}return n=!1,t.next=36,this.getData(e,"file");case 36:t.next=47;break;case 38:if("selected_consensus"!=a.target){t.next=42;break}this.DataHandler.selected_consensus=e,t.next=47;break;case 42:if("discordant"!=a.target){t.next=46;break}this.DataHandler.discordantOnly=e,t.next=47;break;case 46:return t.abrupt("return");case 47:a.full?this.DataHandler.fullUpdate():this.DataHandler.updateCells(),n&&this.$emit("sliderUpdate",{value:this.DataHandler,target:"DataHandler"});case 49:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}()},{key:"getData",value:function(){var t=Object(H["a"])(regeneratorRuntime.mark((function t(e,a){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=this,t.prev=1,t.next=4,n.DataHandler.getData(e,a);case 4:return t.abrupt("return");case 7:throw t.prev=7,t.t0=t["catch"](1),console.log("errr found....."),n.$swal.fire({position:"center",icon:"error",showConfirmButton:!0,title:"JSON parsing error",text:t.t0}),t.t0;case 12:case"end":return t.stop()}}),t,this,[[1,7]])})));function e(e,a){return t.apply(this,arguments)}return e}()},{key:"mounted",value:function(){var t=this;this.getData("".concat(this.DataHandler.data_selected),"file").then((function(e){t.DataHandler.fullUpdate(),t.$emit("sliderUpdate",{value:t.DataHandler,target:"DataHandler"})}))}}]),a}(u["c"]);Object(c["a"])([Object(u["b"])({required:!1,default:null})],R.prototype,"referenceSequence",void 0),Object(c["a"])([Object(u["b"])({required:!1})],R.prototype,"column_width",void 0),Object(c["a"])([Object(u["b"])({required:!1})],R.prototype,"amino_acid_label_option",void 0),Object(c["a"])([Object(u["b"])({required:!1})],R.prototype,"axis_label_option",void 0),Object(c["a"])([Object(u["d"])("isDataSwitched")],R.prototype,"onSwitchedChangeDataType",null),Object(c["a"])([Object(u["d"])("customfile")],R.prototype,"onChangeFile",null),Object(c["a"])([Object(u["d"])("depth_threshold")],R.prototype,"onDepthTChanged",null),R=Object(c["a"])([Object(u["a"])({})],R);var B=R,q=B,M=(a("e91a"),Object(g["a"])(q,O,D,!1,null,"e889df82",null)),E=M.exports,G=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{width:"100%"}},[a("b-row",[a("b-col",{staticClass:"col-lg-12 pb-1 d-flex"},[!t.DataHandler||t.DataHandler.cells.length<1?a("div",[a("hr"),a("strong",{staticClass:"text-danger"},[t._v("No data available")])]):t._e(),a("div",{ref:"heatmapLabels",attrs:{id:"heatmapLabels"}}),a("div",{ref:"heatmapDiv",staticClass:"d-flex overflow-auto",attrs:{id:"heatmapDiv"}},[a("div",{staticClass:"tooltip",staticStyle:{opacity:"0","font-size":"16px",display:"block"},attrs:{id:"tooltipHeatmap"}},[a("div",{attrs:{id:"tooltipcontent"}}),a("b-table",{attrs:{striped:"",hover:"",items:t.tooltiptable,fields:[{key:"aa",label:"AA"},{key:"proportion",label:"Proportion"}]}})],1)])]),a("b-col",{staticClass:"col-lg-12 pb-1"},[a("div",{ref:"heatmapSlider",attrs:{id:"heatmapSlider"}})]),a("b-col",{staticClass:"col-lg-12 pb-1"},[a("div",{ref:"heatmapLegend",attrs:{id:"heatmapLegend"}}),a("b-button",{on:{click:function(e){return t.downloadSVG()}}},[t._v("Save SVG")]),a("a",{attrs:{hidden:"",id:"imgId",target:"_blank"}},[t._v("Save SVG")]),a("b-switch",{attrs:{hidden:"",disabled:!t.DataHandler.cells},model:{value:t.isFlipped,callback:function(e){t.isFlipped=e},expression:"isFlipped"}},[t._v(" "+t._s((t.isFlipped,"Flip Axis"))+" ")])],1)],1)],1)},V=[],$=(a("ac1f"),a("00b4"),a("bf19"),a("2b3d"),a("9861"),a("5319"),a("6b93"),a("25f0"),a("a15b"),a("1276"),a("5b81"),function(t){Object(o["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(s["a"])(this,a),t=e.apply(this,arguments),t.isFlipped=!0,t.customfile=null,t.scrollDirection="x",t.partitions=1,t.position_max=1,t.position_ranges=[1,t.position_max],t.test=null,t.reference_seq=[],t.showMenu=!1,t.msg="Hello",t.tooltiptable=[],t.height=0,t.maxHeight=900,t.boxHeight=0,t.width=900,t.oversize=0,t.border=0,t.svgs={},t.scaleX=S["l"](),t.scaleColor=S["m"](),t.colors={start:"#fff",end:"#666699"},t.xAxisInner={},t.xAxisGroup={},t.xAxisGT=null,t.xAxisGB=null,t.yAxis=null,t.yAxisG=null,t.xAxisT=null,t.xAxisB=null,t.context=null,t.g=null,t.color_range=4,t.divisionYScale={},t.yAxisDivision={},t.scaleY=S["n"](),t.positions_unique=[],t.positions=[],t.preps=null,t.defaultChartHeight=800,t.chartHeight=t.defaultChartHeight,t.legendWidth=0,t.legendHeight=0,t.legendPadding=15,t.svg=null,t.margin={top:.075*t.chartHeight,bottom:.075*t.chartHeight,left:.02*t.width,right:.02*t.width},t.x=S["m"](),t.labelPaddingLeft=15,t.yAxisLabels=[],t}return Object(k["a"])(a,[{key:"onColWidthChanged",value:function(t,e){this.updateHeatmap()}},{key:"onAminoAcidLabelOptionChanged",value:function(t,e){this.updateHeatmap()}},{key:"onAxisLabelOptionChanged",value:function(t,e){this.updateHeatmap()}},{key:"changeDataHandler",value:function(){this.defineHeatmap()}},{key:"parseError",value:function(t){return console.log(t),t.toJSON?t.toJSON().message:t}},{key:"downloadSVG",value:function(){var t=document.querySelector("#innerheatmapSVG"),e=(new XMLSerializer).serializeToString(t),a=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),n=window.URL.createObjectURL(a),i=new Image,r=this.oversize,s=this.height;i.width=this.oversize,i.height=s;var o=this;i.onload=function(){var t=document.createElement("canvas");S["r"]("canvas").append("text").attr("transform","translate(".concat(r/2,",").concat(o.margin.top/2,")")).text("yyyyyyyyyyyyyyyyyyyyyyyyyy"),t.width=r,t.height=s;var e=t.getContext("2d");e.drawImage(i,0,0,r,s),e.font="20px Arial",e.fillText(o.DataHandler.protein,r/2,o.margin.top/2),window.URL.revokeObjectURL(n);var a=t.toDataURL("image/jpeg"),l=document.getElementById("imgId");l.download="export_"+Date.now()+".jpeg",l.href=a,l.click()},i.src=n}},{key:"mounted",value:function(){this.DataHandler.cells&&this.defineHeatmap()}},{key:"defineHeatmap",value:function(){var t=this,e=this.DataHandler.cells;if(!(e.length<1)){S["s"]("#heatmapSVG").remove(),S["r"]("#overflowDiv").remove(),S["s"]("#heatmapSliderSVG").remove(),S["s"]("#heatmapLegend").selectAll("*").remove(),S["r"]("#labelsSVG").remove();var a=S["h"](e.map((function(t){return t.position})));this.position_max=a,this.position_ranges=[1,a];var n=Object(j["a"])(new Set(e.map((function(t){return t.experiment}))));this.preps=n,this.yAxisLabels=Object(j["a"])(new Set(e.map((function(t){return t.yAxisLabel}))));var i=(this.defaultChartHeight-this.margin.top-this.margin.bottom)/this.preps.length,r=30;if(this.boxHeight=Math.min(i,r),this.$emit("update:column_width",this.boxHeight),this.column_width<=20&&this.$emit("update:amino_acid_label_option","None"),this.boxHeight===r?(this.height=this.margin.top+this.margin.bottom+r*this.preps.length,this.chartHeight=this.margin.top+this.margin.bottom+r*this.preps.length):(this.height=this.maxHeight,this.chartHeight=this.defaultChartHeight),"x"==this.scrollDirection){this.x.domain([0,a]).range([this.margin.left,this.width*this.column_width-this.margin.right]);var s=this.x(0),o=this.x(a);this.oversize=o-s+this.margin.left+this.margin.right}else{this.x.domain([0,a]).range([this.margin.top,this.height*this.column_width-this.margin.bottom]);var l=this.x(0),c=this.x(a);this.oversize=c-l+this.margin.top+this.margin.bottom}var u=S["r"]("#heatmapDiv"),p=u.append("svg").attr("id","heatmapSVG").attr("ref","heatmapSVG").style("position","absolute").style("pointer-events","none").style("z-index",1).attr("viewBox","0 0 ".concat(this.width," ").concat(this.chartHeight));this.svg=p;var h=u.append("div").attr("id","overflowDiv").style("overflow-x","scroll").style("height",this.chartHeight),d=h.append("svg").attr("id","innerheatmapSVG").style("display","block");"x"==this.scrollDirection?d.attr("height",this.chartHeight):d.attr("width",this.width);var f=d.append("g").attr("class","svgG");this.g=f;var m=this;this.xAxisGT=f.append("g").attr("class","xAxis").attr("id","xAxisT"),this.xAxisGB=f.append("g").attr("class","xAxis").attr("id","xAxisB");var g=S["r"]("#heatmapLabels"),b=g.append("svg").attr("id","labelsSVG").attr("ref","labelsSVG").style("pointer-events","none").style("z-index",1).style("height","100%"),v=b.append("g").attr("class","svgG");this.yAxisG=v.append("g").attr("class","yAxis").attr("id","yAxis");try{this.legendWidth=Math.max(this.$refs.heatmapLegend.clientWidth,this.width),this.width=Math.max(this.$refs.heatmapDiv.clientWidth,this.width)}catch(B){console.log(B)}this.legendHeight=this.defaultChartHeight/20,this.height=Math.min(this.chartHeight);for(var y=[],_=-5;_<=0;_+=.25)y.push(_);var x=this.legendWidth/4/y.length,w=this.legendHeight-this.legendPadding;S["r"]("#heatmapLegend").append("svg").attr("viewBox","0 0 ".concat(this.legendWidth," ").concat(this.legendHeight)).attr("transform","translate(".concat(0,",",this.legendPadding,")")).append("g").attr("class","legendG").attr("transform","translate(".concat(this.legendWidth/2,",",0,")")).selectAll("rect").data(y).enter().append("rect").attr("stroke-width",0).attr("x",(function(t,e){return x*e})).attr("y",0).attr("id",(function(t){return"_"+String(t).replace("-","_").replace(".","_")})).attr("width",x).attr("height",w).style("fill",(function(e){var a=(e+3.5)/3.5,n=t.frac2Color(a);return n})).on("mouseenter",(function(e,a){S["r"]("#_"+String(a).replace("-","_").replace(".","_")).attr("stroke-width",2).attr("stroke","#000");var n=(a+3.5)/3.5;S["s"](".block").style("fill",(function(e,a){return t.getFrac(e)>=n?"rgb(217, 33, 32)":t.calculateColor(e)}))})).on("mouseleave",(function(e,a){S["r"]("#_"+String(a).replace("-","_").replace(".","_")).attr("stroke-width",0),S["s"](".block").style("fill",(function(e,a){return t.calculateColor(e)}))})).style("cursor","pointer").append("title").attr("class","tt").text((function(t){var e=Math.round(3-Math.log10(Math.pow(10,t)));return(100*Math.pow(10,t)).toString().substring(0,e)+"%"}));var k=S["m"]().domain([-5,0]).range([x/2,x*y.length-x/2]),O=S["a"](k).ticks(6).tickFormat((function(t,e){var a=parseFloat((100*Math.pow(10,t)).toFixed(3));return(a>.01?a:a.toExponential())+"%"}));S["r"]("#heatmapLegend").select(".legendG").append("g").attr("class","legendyAxis").attr("id","legendyAxis").attr("transform","translate(0,"+w+")").style("stroke-width",1).call(O).selectAll("text").style("text-anchor","start").attr("transform","rotate(0)").style("font-size","0.79em"),S["r"]("#heatmapLegend").select("svg").append("text").attr("x",this.legendWidth/2-this.legendPadding).attr("y",this.legendPadding).attr("dy","-0.25em").attr("text-anchor","end").attr("transform","rotate(0)").attr("id","legendYAxisTitle").attr("font-size","0.8em").text("Relative Depth of Mutations");var D=70;this.context=S["r"]("#heatmapSlider").append("svg").attr("id","heatmapSliderSVG").attr("viewBox","0 0 ".concat(this.width," ").concat(D)).append("g").attr("class","context").attr("transform","translate(".concat(0,",",0,")"));var H=S["m"]().domain([0,a]).range([0,this.width]),C=D/n.length,A=S["n"]().domain(n).range(n.map((function(t,e){return e*C}))),P=(this.context.selectAll(".subBar").data(this.DataHandler.cells).join((function(t){return t.append("rect").classed("subBar",!0).attr("transform",(function(t,e){return"translate("+H(t.position)+","+A(t.experiment)+")"})).style("cursor","pointer").attr("width",m.width/a).attr("height",C).attr("fill",(function(t){return m.calculateColor(t)}))}),(function(t){return t.attr("transform",(function(t,e){return"translate("+H(t.position)+","+A(t.prep)+")"})).attr("fill",(function(t){return m.calculateColor(t)}))}),(function(t){return t.remove()})),S["d"]().extent([[0,0],[this.width,D]]).on("end",L));this.context.append("g").attr("class","x brush").call(P).selectAll("rect").attr("y",-6).attr("height",D+7),this.updateHeatmap()}function L(t){t&&!t.selection?(m.DataHandler.updatePositions(S["e"](m.DataHandler.cells_full,(function(t){return t.position}))),m.DataHandler.updateCells(),m.updateHeatmap()):R(t)}function R(t){var e=t.selection;if(e){var a=e.map(H.invert,H).map((function(t){return Math.round(t)}));m.DataHandler.updatePositions(a),m.DataHandler.updateCells()}m.updateHeatmap()}}},{key:"updateHeatmap",value:function(){var t=this,e=this.DataHandler.cells;if(!(e.length<1)){console.log("updating heatmap");var a={x:null,y:null,marginA:null,marginB:null},n=this.DataHandler.protein,i=this.DataHandler.organism,r=this;if(this.position_ranges=this.DataHandler.position_ranges,this.positions_unique=this.DataHandler.protein_map[i[0]][n].split(""),this.DataHandler.discordantOnly){var s=Object(j["a"])(new Set(e.map((function(t){return t.position}))));this.positions=s}else this.positions=S["k"](1,this.positions_unique.length);var o=S["e"](this.positions);e=e.filter((function(t){return+t.position>=o[0]&&+t.position<=o[1]}));var l=this.DataHandler.referenceSequence,c=Math.max(this.DataHandler.position_ranges[0],S["i"](r.positions)),u=Math.min(this.position_max,S["h"](r.positions));this.positions=this.positions.filter((function(t){return t<=u&&t>=c})).sort((function(t,e){return t-e})),"x"==this.scrollDirection?(a["x"]=this.positions,a.xTicks=this.positions_unique,a["y"]=this.yAxisLabels,a.marginA=this.margin.left,a.marginB=this.margin.right,a.long=this.width):(a["x"]=this.preps,a["y"]=this.positions,a.long=this.height,a.xTicks=this.preps,a.marginA=this.margin.top,a.marginB=this.margin.bottom);var p={};e.forEach((function(e,a){"Consensus amino acids"===t.axis_label_option?p[e.position]="".concat(e.consensus_aa,".").concat(e.position):"Reference amino acids"===t.axis_label_option?p[e.position]="".concat(e.aa,".").concat(e.position):p[e.position]="".concat(e.position)})),l&&Object.keys(l).forEach((function(t){p[t]="".concat(l[t],".").concat(t)})),this.oversize=this.positions.length*this.column_width+a.marginA+a.marginB,this.scaleX.domain(this.positions).range([a.marginA,this.oversize-a.marginB]),this.scaleY.domain(a.y).range(a["y"].map((function(e,a){return a*t.boxHeight+t.margin.top}))),this.yAxis=S["b"](this.scaleY).ticks(a.y.length+1),this.xAxisT=S["c"](this.scaleX).tickSizeOuter(0).ticks(u-c).tickFormat((function(t,e){return e%2!==0?" ":p[t]})),this.xAxisB=S["a"](this.scaleX).tickSizeOuter(0).ticks(u-c).tickFormat((function(t,e){return e%2!==1?" ":p[t]}));var h=S["r"]("#yAxis").attr("transform","translate("+this.labelPaddingLeft+","+this.boxHeight/2+")").style("stroke-width",0).call(this.yAxis).call((function(t){return t.select(".domain").remove()})).selectAll("text").classed("scaleYText",!0).style("text-anchor","start").attr("transform","rotate(0)").style("font-size","14px"),d=S["r"]("#xAxisT").attr("transform","translate(0,"+this.margin.top+")").style("fill",null).style("stroke-width",.2).call(this.xAxisT).selectAll("text").attr("y",-9).attr("x",0).attr("dy",".35em").attr("transform","rotate(45)").style("text-anchor","end").style("font-size","14px"),f=S["r"]("#xAxisB").attr("transform","translate(0,"+(this.chartHeight-this.margin.bottom)+")").style("fill",null).style("stroke-width",.2).call(this.xAxisB).selectAll("text").classed("scaleXText",!0).attr("transform","rotate(45)").style("text-anchor","start").style("font-size","16px");try{S["h"](f.nodes().map((function(t){return t.getBBox().height})));var m=S["h"](h.nodes().map((function(t){return t.getBBox().height})));h.style("font-size",Math.min(m,this.boxHeight));var g=S["h"](f.nodes().map((function(t){return t.getBBox().width})));g>this.column_width&&(f.style("font-size",Math.min(14,g,this.column_width)),d.style("font-size",Math.min(14,g,this.column_width)))}catch(v){console.error(v)}var b=h.node().getBBox().width+this.labelPaddingLeft;S["r"]("#labelsSVG").attr("viewBox","0 0 ".concat(b," ").concat(this.$refs.heatmapDiv.clientHeight)),S["r"]("#innerheatmapSVG").attr("width",this.oversize).style("fill","white"),this.g.selectAll(".block").data(e,(function(t,e){t.experiment.replaceAll(" ","_").replaceAll("-","_"),t.position,t.prep_id,r.DataHandler.protein,t.pdb_aa})).join((function(t){var e=t.append("g");e.on("click",(function(t,e){r.DataHandler.selectedPosition=e.position,r.$emit("changePosition",e.position),r.$emit("changePdb",e.pdb)})).on("mousemove",(function(t,e,a,n){r.highlightCell(t,e)})).on("mouseleave",(function(t,e){r.unHighlight(event,e)})).style("cursor","pointer").attr("class","block"),e.append("rect").attr("id",(function(t){return"_"+t.experiment.replaceAll(" ","_").replaceAll("-","_")+t.position})).attr("fill",(function(t){return r.calculateColor(t)})).attr("transform",(function(t){var e,a;return"x"==r.scrollDirection?(a=r.scaleY(t.experiment),e=r.scaleX(t.position)):(e=r.scaleY(t.experiment),a=r.scaleX(t.position)),"translate("+e+","+a+")"})).attr("width",r.column_width).attr("height",r.boxHeight),"None"==r.amino_acid_label_option||e.append("text").text((function(t){return"Consensus amino acids"==r.amino_acid_label_option?t.consensus_aa:"Reference amino acids"==r.amino_acid_label_option?t.aa:void 0})).attr("fill","currentColor").attr("x",(function(t){return r.scaleX(t.position)+r.column_width/3})).attr("y",(function(t){return r.scaleY(t.experiment)+r.boxHeight/1.5}))}),(function(t){return t.call((function(t){t.transition().duration(1e3).attr("fill",(function(t){return r.calculateColor(t)}))})).attr("transform",(function(t){var e,a;return"x"==r.scrollDirection?(a=r.scaleY(t.experiment),e=r.scaleX(t.position)):(e=r.scaleY(t.experiment),a=r.scaleX(t.position)),"translate("+e+","+a+")"})).attr("width",r.column_width)}),(function(t){return t.remove()}))}}},{key:"highlightCell",value:function(t,e){var a=this;S["r"]("#_"+e.experiment.replaceAll(" ","_").replaceAll("-","_")+e.position).style("fill","yellow");var n=1-e.aa_count/e.depth;a.focusColumn(e.position,!1),S["r"]("#tooltipHeatmap").style("left",(function(){var e=S["r"]("#tooltipHeatmap").node()?S["r"]("#tooltipHeatmap").node().getBoundingClientRect().width:0;return S["j"](t,a.svg.node())[0]-e+"px"})).style("top",(function(){var e=S["r"]("#tooltipHeatmap").node()?S["r"]("#tooltipHeatmap").node().getBoundingClientRect().height:0;return S["j"](t,a.svg.node())[1]-e/2+"px"})).style("opacity","1").select("#tooltipcontent").html("Pos: ".concat(e.position,"<br>\n      Experiment: ").concat(e.experiment,"<br>\n      Depth: ").concat(e.depth,"<br>\n      Total: ").concat(e.total,"<br>\n      Reference Residue: ").concat(e.aa,"<br>\n      Protein: ").concat(e.protein,"<br>\n      PDB Residue: ").concat(e.pdb_aa,"<br>\n      Consensus Residue: ").concat(e.consensus_aa,"<br>\n      Consensus / Total: ").concat(n.toFixed(3)," ","<br>Ref. Residue: ".concat(a.positions_unique[a.positions.indexOf(e.position)])," ")),a.tooltiptable=e.unique.map((function(t){return t.aa==e.aa?t._rowVariant="info":e.aa!==t.aa&&t.aa==e.consensus_aa&&(t._rowVariant="danger"),t}))}},{key:"unHighlight",value:function(t,e){var a=this;S["r"]("#_"+e.experiment.replaceAll(" ","_").replaceAll("-","_")+e.position).style("fill",(function(t){return a.calculateColor(t)})),this.unfocusColumn(e.position),S["r"]("#tooltipHeatmap").style("opacity","0")}},{key:"focusColumn",value:function(t,e){var a=this.scaleX(t),n=[a,a+this.column_width];S["s"](".focus").remove();var i=S["e"](this.scaleY.range());if(this.g.selectAll(".focus").data(n).enter().append("line").attr("x1",(function(t){return t})).attr("x2",(function(t){return t})).attr("y1",i[0]).style("stroke","black").style("stroke-width",.5).attr("y2",this.boxHeight+i[1]).attr("class","focus"),e){var r=document.querySelector("#overflowDiv");if(r){var s=this.scaleX(t.toString());r.scrollLeft=s-this.width/2}}}},{key:"unfocusColumn",value:function(t){S["s"](".focus").remove()}},{key:"frac2Color",value:function(t){var e="",a=.25+.75*t,n=255*(.472-.567*a+4.05*Math.pow(a,2))/(1+8.72*a-19.17*Math.pow(a,2)+14.1*Math.pow(a,3)),i=255*(.108932-1.22635*a+27.284*Math.pow(a,2)-98.577*Math.pow(a,3)+163.3*Math.pow(a,4)-131.395*Math.pow(a,5)+40.634*Math.pow(a,6)),r=255/(1.97+3.54*a-68.5*Math.pow(a,2)+243*Math.pow(a,3)-297*Math.pow(a,4)+125*Math.pow(a,5));return e=n<0||i<0||r<0?"rgb(253,64,160)":"rgb("+Math.round(n)+","+Math.round(i)+","+Math.round(r)+")",e}},{key:"getFrac",value:function(t){var e=4,a=t.max;return t.total!==a?(e+Math.log10(1-a/t.total))/e:.9999999}},{key:"calculateColor",value:function(t){var e=this.DataHandler.depth_threshold,a=this.DataHandler.frequency_threshold,n=t.aa_count,i="",r=["rgb("+Math.round(245)+","+Math.round(242)+","+Math.round(242)+")","rgb("+Math.round(185)+","+Math.round(185)+","+Math.round(185)+")","rgb("+Math.round(235)+","+Math.round(235)+","+Math.round(235)+")","rgb("+Math.round(65)+","+Math.round(65)+","+Math.round(65)+")","rgb(253,64,160)"];if(0===t.total)i=r[0];else if(t.total<e&&1-n/t.total<a)i=r[1];else if(n==t.total&&t.total>=e)i=r[2];else if(n!=t.total&&t.total<e&&1-n/t.total>=a||n==t.total&&t.total<e)i=r[3];else{var s=this.getFrac(t),o=["#82e09b","#a82716"];S["o"]([.25,1],o);i=this.frac2Color(s)}return i}}]),a}(u["c"]));Object(c["a"])([Object(u["b"])({required:!1,default:9})],$.prototype,"column_width",void 0),Object(c["a"])([Object(u["b"])({required:!0,default:null})],$.prototype,"DataHandler",void 0),Object(c["a"])([Object(u["b"])({required:!1,default:!0})],$.prototype,"amino_acid_label_option",void 0),Object(c["a"])([Object(u["b"])({required:!1,default:!0})],$.prototype,"axis_label_option",void 0),Object(c["a"])([Object(u["d"])("column_width")],$.prototype,"onColWidthChanged",null),Object(c["a"])([Object(u["d"])("amino_acid_label_option")],$.prototype,"onAminoAcidLabelOptionChanged",null),Object(c["a"])([Object(u["d"])("axis_label_option")],$.prototype,"onAxisLabelOptionChanged",null),$=Object(c["a"])([Object(u["a"])({components:{}})],$);var z=$,T=z,I=Object(g["a"])(T,G,V,!1,null,null,null),F=I.exports,U=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-row",[a("b-col",{staticClass:"col-lg-12 pb-1"},[a("div",{},[a("b-field",{attrs:{label:t.title}}),a("div",[a("b-input-group",{staticClass:"mt-3",attrs:{prepend:"PDB ID"}},[a("b-form-input",{attrs:{type:"text"},model:{value:t.pdb_local,callback:function(e){t.pdb_local=e},expression:"pdb_local"}}),a("b-input-group-append",[a("b-button",{attrs:{elevation:"2"},on:{click:function(e){t.proteinChange(t.pdb_local.toLowerCase())}}},[t._v("Change Protein")])],1)],1)],1),a("div",{ref:"viewer",staticClass:"viewer"}),a("b-field",{staticClass:"column is-narrow pl-0",attrs:{label:"Molecule Structure"}},[a("b-switch",{model:{value:t.isSwitched,callback:function(e){t.isSwitched=e},expression:"isSwitched"}},[t._v(" "+t._s(t.isSwitched?"Biological Assembly":"Asymmetric Unit")+" ")])],1),t.queryingReferenceSequence?a("b-field",{attrs:{label:"Querying Reference Sequence..."}}):t._e(),t.queryingResidueMapping?a("b-field",{attrs:{label:"Querying Residue Mapping.."}}):t._e(),t.chain_focus?a("b-field",{staticClass:"column is-narrow",attrs:{label:"Chains at "+t.localPosition}},[a("b-select",{attrs:{placeholder:"Chain",options:t.available_focus_chains},on:{change:function(e){return t.focus()}},model:{value:t.chain_focus,callback:function(e){t.chain_focus=e},expression:"chain_focus"}})],1):t._e()],1)]),a("b-col",{staticClass:"col-lg-12 pb-1"},[a("BindingSites",{attrs:{positions:t.positions,chains:t.chains},on:{siteHover:t.siteHover}})],1)],1)},N=[],W=a("b85c"),J=a("bc3a"),X=a.n(J),Y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{},[t.ligands&&t.ligands.length>0?a("b-table",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.right",modifiers:{hover:!0,right:!0}}],staticStyle:{cursor:"pointer"},attrs:{hover:"",items:t.ligands,"sticky-header":"22rem",title:"Click to view in heatmap and molecule viewer",fields:[{key:"startIndex",label:"Start Index",sticky:!0},{key:"endIndex",label:"End Index",sticky:!0},{key:"dataType",label:"Type",sticky:!0},{key:"startCode",label:"Start",sticky:!0},{key:"endCode",label:"End",sticky:!0},{key:"name",label:"Name",sticky:!0},{key:"entity",label:"Chain",sticky:!0}]},on:{"row-clicked":t.rowClicked}}):t.ligandQuerying?a("p",{staticClass:"warning"},[t._v("Getting Ligand information")]):a("p",{staticClass:"warning"},[t._v("No ligand information available")])],1)},Q=[],K=(a("820e"),function(t){Object(o["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(s["a"])(this,a),t=e.apply(this,arguments),t.ligands=[],t.ligandQuerying=!1,t}return Object(k["a"])(a,[{key:"onColWidthChanged",value:function(t,e){this.queryLigands(t)}},{key:"mounted",value:function(){this.queryLigands(this.chains)}},{key:"getdata",value:function(){var t=Object(H["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,X.a.get(e);case 2:return a=t.sent,t.abrupt("return",a);case 4:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"rowClicked",value:function(t){var e=t;e.focus=!0,this.$emit("siteHover",t)}},{key:"rowunHovered",value:function(t){var e=t;e.focus=!1,this.$emit("siteHover",t)}},{key:"queryLigands",value:function(){var t=Object(H["a"])(regeneratorRuntime.mark((function t(e){var a,n,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=[],n=[],this.ligandQuerying=!0,e.entities.forEach((function(t){a.push(i.getdata("https://www.ebi.ac.uk/pdbe/graph-api/pdbe_pages/binding_sites/".concat(e.id,"/").concat(t)))})),Promise.allSettled(a).then((function(t){t.forEach((function(t){if("fulfilled"==t.status&&t.value.data){var a=t.value.data;a[e.id].data.forEach((function(t){t.residues.map((function(e,a){return e.entity=t.additionalData.entityId,e.name=t.accession,e.dataType=t.dataType,e})),n.push.apply(n,Object(j["a"])(t.residues))}))}})),i.ligands=n,i.ligandQuerying=!1})).catch((function(t){console.log(t)}));case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()}]),a}(u["c"]));Object(c["a"])([Object(u["b"])({required:!0,default:6})],K.prototype,"chains",void 0),Object(c["a"])([Object(u["d"])("chains",{deep:!0})],K.prototype,"onColWidthChanged",null),K=Object(c["a"])([Object(u["a"])({})],K);var Z=K,tt=Z,et=Object(g["a"])(tt,Y,Q,!1,null,null,null),at=et.exports,nt=function(t){Object(o["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(s["a"])(this,a),t=e.apply(this,arguments),t.chain_focus=null,t.entity_focus=null,t.available_focus_chains=[],t.pdb_local="",t.map_positions={},t.queryingResidueMapping=!1,t.queryingReferenceSequence=!1,t.localPosition=55,t.referenceSequence={},t.isSwitched=!0,t.assemblyId="1",t.positions=[],t.custompdb=null,t.chains={id:null,entities:[]},t.title="No title found",t}return Object(k["a"])(a,[{key:"onPositionChanged",value:function(t,e){this.localPosition=t,this.focus()}},{key:"CustomPDBFile",value:function(t,e){console.log(t)}},{key:"onRefSeqChange",value:function(t,e){t&&Object.keys(t).length>0&&this.$emit("changeReferenceSequence",t)}},{key:"onDataChanged",value:function(t,e){this.pdb_local=t,this.proteinChange(t)}},{key:"onSwitchToggled",value:function(t,e){this.assemblyId=!0===t?"1":"preffered",this.proteinChange(this.pdb)}},{key:"onPdbChanged",value:function(t,e){null===t||""===t?this.proteinChange(null):this.proteinChange(t)}},{key:"siteHover",value:function(t){this.localPosition=t.endIndex+this.map_positions[t.entity].positions[1],this.focus(),this.localPosition>=this.DataHandler.position_ranges[0]&&this.localPosition<=this.DataHandler.position_ranges[1]&&(t.position=this.localPosition,this.$emit("siteHover",t))}},{key:"parseError",value:function(t){return console.log(t),t.toJSON?t.toJSON().message:t}},{key:"proteinChange",value:function(t){this.chain_focus=null;var e={assemblyId:this.assemblyId,hideControls:!0,bgColor:{r:255,g:255,b:255}};null===t?e.customData={url:"empty.pdb",format:"mmcif"}:e.moleculeId=t,this.queryAPI(e),this.viewer.visual.update(e),this.removeButtons()}},{key:"reportError",value:function(t,e){var a=this.parseError(t);this.$swal.fire({position:"center",icon:"error",showConfirmButton:!0,title:e,text:a})}},{key:"queryAPI",value:function(){var t=Object(H["a"])(regeneratorRuntime.mark((function t(e){var a,n,i,r,s,o,l,c,u=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(null,void 0!==e.moleculeId){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,this.queryingResidueMapping=!0,t.next=7,this.getdata("https://www.ebi.ac.uk/pdbe/graph-api/mappings/uniprot_segments/".concat(e.moleculeId.toLowerCase()));case 7:a=t.sent,this.title="Fetching...",this.map_positions={},a.data&&a.data[e.moleculeId]&&a.data[e.moleculeId].UniProt&&(n=a.data[e.moleculeId].UniProt,i=Object.keys(a.data[e.moleculeId].UniProt),1,i.forEach((function(t){if(n[t].mappings){var a=n[t].mappings;u.chains={id:e.moleculeId,entities:Object(j["a"])(new Set(a.map((function(t){return t.entity_id}))))},a.forEach((function(t){u.map_positions.hasOwnProperty(t.entity_id)||(u.map_positions[t.entity_id]={chains:[],positions:[]}),u.map_positions[t.entity_id].chains.push(t.struct_asym_id),u.map_positions[t.entity_id].positions=[t.start.residue_number,t.unp_start-t.start.residue_number,t.end.residue_number,t.unp_end-t.start.residue_number+1]}))}})),r=Object.keys(this.map_positions).sort(),s=0,r.forEach((function(t){u.map_positions[t].positions[1]<s&&(u.map_positions[t].positions[1]=s,u.map_positions[t].positions[3]=s+u.map_positions[t].positions[2]),s=u.map_positions[t].positions[3]+u.map_positions[t].positions[0]})),this.pdb=e.moleculeId),t.next=17;break;case 13:t.prev=13,t.t0=t["catch"](3),console.error(t.t0),this.reportError(t.t0,"Error in fetching Query for uniprot mappings from pdbID");case 17:return t.prev=17,this.queryingResidueMapping=!1,t.prev=19,this.queryingReferenceSequence=!0,this.referenceSequence={},t.next=24,this.getdata("https://www.ebi.ac.uk/pdbe/search/pdb/select?q=pdb_id:".concat(e.moleculeId,"&wt=json"));case 24:o=t.sent,o.data&&o.data.response&&o.data.response.docs&&(l=o.data.response.docs,c={},l.forEach((function(t){if(t.entity_id in u.map_positions){t.title?u.title=t.title:u.title="No title found",u.map_positions[t.entity_id].chains=u.map_positions[t.entity_id].chains.sort();t.struct_asym_id;for(var e=u.map_positions[t.entity_id].positions[1];e<u.map_positions[t.entity_id].positions[3];e++)if(e>=0){var a=u.determinePosition(e,u.map_positions[t.entity_id].positions[1]),n=t.molecule_sequence.substring(a,a+1);c[e+1]=n}}}))),t.next=31;break;case 28:t.prev=28,t.t1=t["catch"](19),this.reportError(t.t1,"Error in Fetching Reference Info");case 31:return t.prev=31,this.queryingReferenceSequence=!1,t.finish(31);case 34:return t.finish(17);case 35:case"end":return t.stop()}}),t,this,[[3,13,17,35],[19,28,31,34]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"make_pdbemolstar",value:function(){var t=Object(H["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.viewer=new PDBeMolstarPlugin,this.viewer.render(this.$refs.viewer,e),this.removeButtons();case 3:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getdata",value:function(){var t=Object(H["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,X.a.get(e);case 2:return a=t.sent,t.abrupt("return",a);case 4:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"mounted",value:function(){var t=Object(H["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e={assemblyId:this.assemblyId,hideControls:!0,bgColor:{r:255,g:255,b:255}},null===this.pdb?e.customData={url:"empty.pdb",format:"mmcif"}:e.moleculeId=this.pdb,this.make_pdbemolstar(e),this.queryAPI(e);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"determinePosition",value:function(t,e){return t-e}},{key:"focus",value:function(){var t,e={chain:"",entity:"",position:0},a=Object(W["a"])(Object.keys(this.map_positions).sort().filter((function(t){return"total"!=t})));try{for(a.s();!(t=a.n()).done;){var n=t.value;if(this.localPosition>=this.map_positions[n].positions[1]&&this.localPosition<=this.map_positions[n].positions[3]){var i=this.determinePosition(this.localPosition,this.map_positions[n].positions[1]);this.chain_focus&&this.entity_focus==n||(this.chain_focus=this.map_positions[n].chains[0],this.available_focus_chains=this.map_positions[n].chains),this.entity_focus=n,e={chain:this.chain_focus,entity:n,position:i},!0;break}}}catch(r){a.e(r)}finally{a.f()}""!==e.chain&&this.viewer.visual.select({data:[{struct_asym_id:e.chain,entity_id:e.entity,residue_number:e.position,focus:!0,color:{r:255,g:255,b:0}}]})}},{key:"reset",value:function(){this.viewer.visual.reset({camera:!0}),this.viewer.visual.clearSelection()}},{key:"removeButtons",value:function(){var t=document.querySelector('[title="Toggle Expanded Viewport"]');t&&t.remove()}}]),a}(u["c"]);Object(c["a"])([Object(u["b"])({required:!0,default:55})],nt.prototype,"position",void 0),Object(c["a"])([Object(u["b"])({required:!0,default:null})],nt.prototype,"pdb",void 0),Object(c["a"])([Object(u["b"])({required:!0,default:null})],nt.prototype,"DataHandler",void 0),Object(c["a"])([Object(u["d"])("position")],nt.prototype,"onPositionChanged",null),Object(c["a"])([Object(u["d"])("custompdb")],nt.prototype,"CustomPDBFile",null),Object(c["a"])([Object(u["d"])("referenceSequence",{immediate:!0,deep:!0})],nt.prototype,"onRefSeqChange",null),Object(c["a"])([Object(u["d"])("DataHandler.pdb")],nt.prototype,"onDataChanged",null),Object(c["a"])([Object(u["d"])("isSwitched")],nt.prototype,"onSwitchToggled",null),Object(c["a"])([Object(u["d"])("pdb")],nt.prototype,"onPdbChanged",null),nt=Object(c["a"])([Object(u["a"])({components:{BindingSites:at}})],nt);var it=nt,rt=it,st=(a("d698"),Object(g["a"])(rt,U,N,!1,null,"9f4dd7ae",null)),ot=st.exports,lt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-row",{},[a("b-col",{staticClass:"col-lg-10 pb-1"},[a("div",{ref:"barPlotDiv",style:{height:t.containerHeight+"px"},attrs:{id:"barPlotDiv"}}),a("div",{ref:"barPlotLegend",staticStyle:{"padding-top":"50px"},attrs:{id:"barPlotLegend"}})]),a("b-col",{staticClass:"col-lg-2 pb-1"},[a("b-field",{attrs:{label:"Scale"}},[a("b-select",{attrs:{options:t.scales},on:{change:function(e){return t.makeBarPlot()}},model:{value:t.selected_scale,callback:function(e){t.selected_scale=e},expression:"selected_scale"}})],1),a("b-field",[a("b-button",{on:{click:function(e){return t.downloadSVG()}}},[t._v("Save SVG")])],1),a("hr"),a("b-field",[a("p",{staticStyle:{"text-align":"center"}},[t._v("Position: "+t._s(t.localPosition))])]),a("b-field",[a("p",{staticStyle:{"text-align":"center"}},[t._v("protein: "+t._s(t.DataHandler.protein))])])],1)],1)},ct=[],ut=function(t){Object(o["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(s["a"])(this,a),t=e.apply(this,arguments),t.svg=null,t.containerHeight=300,t.chartHeight=t.containerHeight,t.width=0,t.localPosition=t.DataHandler.position_min,t.margin={top:.045*t.chartHeight,bottom:.45*t.chartHeight,left:.05*t.width,right:1e-4*t.width},t.oversize=0,t.scales=["Linear","Sqrt","Log"],t.selected_scale=t.scales[0],t.colors=["#e6194b","#3cb44b","#ffe119","#4363d8","#f58231","#911eb4","#46f0f0","#f032e6","#bcf60c","#fabebe","#008080","#e6beff","#9a6324","#fffac8","#800000","#aaffc3","#808000","#ffd8b1","#000075","#808080","red","#000"],t.aas=["M","K","A","I","L","V","Y","T","F","N","D","C","G","H","S","E","P","W","R","Q"],t}return Object(k["a"])(a,[{key:"onDataHandlerChanged",value:function(t,e){this.localPosition=t,this.makeBarPlot()}},{key:"changeDataHandler",value:function(){this.makeBarPlot()}},{key:"downloadSVG",value:function(){var t=document.querySelector("#innerheatmapSVGBarPlot"),e=(new XMLSerializer).serializeToString(t),a=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),n=window.URL.createObjectURL(a),i=new Image,r=this.width,s=this.containerHeight+50;i.width=this.width,i.height=s;var o=this;i.onload=function(){var t=document.createElement("canvas");S["r"]("canvas").append("text").attr("transform","translate(".concat(r/2,",").concat(o.margin.top/2,")")).text("yyyyyyyyyyyyyyyyyyyyyyyyyy"),t.width=r,t.height=s;var e=t.getContext("2d");e.drawImage(i,0,0,r,s),e.font="16px Arial",e.fillText("protein: ".concat(o.DataHandler.protein,", Position: ").concat(o.localPosition),r/2,s-25),window.URL.revokeObjectURL(n);var a=t.toDataURL("image/jpeg"),l=document.getElementById("imgId");l.download="export_"+Date.now()+".jpeg",l.href=a,l.click()},i.src=n}},{key:"makeBarPlot",value:function(){var t=this;if(!(this.DataHandler.cells.length<1)){var e=this;S["r"]("#barPlotDiv").selectAll("*").remove(),S["r"]("#barPlotLegend").selectAll("*").remove();var a=Object(j["a"])(new Set(this.DataHandler.cells.map((function(t){return t.experiment})))),n=S["f"](this.DataHandler.cells,(function(t){return t.position==e.localPosition})).map((function(e){var a={prep:e.experiment};return e.unique.map((function(t){a[t.aa]=+t.proportion})),t.aas.forEach((function(t){t in a||(a[t]=0)})),a})),i=(this.$refs.barPlotDiv.clientWidth-this.margin.right-this.margin.left)/a.length,r=15;i=Math.max(i,r);var s=i*a.length;this.width=s+this.margin.right+this.margin.left,this.chartHeight=this.containerHeight-this.margin.top-this.margin.bottom;var o=S["r"]("#barPlotDiv");this.svg=o.append("svg").attr("id","barPlotSVG").attr("ref","barPlotSVG").attr("width",this.width).attr("height",this.containerHeight).style("position","absolute").style("pointer-events","none").style("z-index",1);var l=o.append("div").attr("id","overflowDivBarPlot").style("overflow-x","scroll"),c=l.append("svg").attr("id","innerheatmapSVGBarPlot").style("display","block").style("background","#fff").style("fill","#fff").attr("width",this.width).attr("height",this.containerHeight),u=c.append("g").attr("id","svgG"),p=S["l"]().domain(a).range([this.margin.left,this.width]),h=S["a"](p).ticks(5).tickSizeOuter(0).tickSize(0),d=u.append("g").attr("class","xAxis").attr("id","xAxisTBar").attr("transform","translate(0,"+this.chartHeight+")").style("fill",null).style("stroke-width",.2).call(h);d.selectAll("text").style("text-anchor","start").attr("transform","rotate(45)").style("font-size","1em");var f=null;f="Linear"==this.selected_scale?S["m"]().domain([0,1]).range([this.chartHeight,this.margin.top]):"Sqrt"==this.selected_scale?S["p"]().domain([0,1]).range([this.chartHeight,this.margin.top]):S["q"]().clamp(!0).domain([0,1]).range([this.chartHeight,this.margin.top]);var m=S["b"](f).ticks(5).tickSizeOuter(0).tickSize(0),g=u.append("g").attr("class","yAxis").attr("id","yAxisTBar").attr("transform","translate("+this.margin.left+",0)").style("fill",null).style("stroke-width",.2).call(m),b=S["n"]().domain(this.colors).range(this.colors),v=S["t"]().keys(this.aas)(n).map((function(t){return t.forEach((function(e){e.key=t.key})),t}));u.attr("id","barPlotG").selectAll(".barG").data(v).enter().append("g").classed("barG",!0).selectAll(".posBar").data((function(t){return t})).join((function(t){return t.append("rect").classed("posBar",!0).attr("transform",(function(t,e){return"translate("+p(t.data.prep)+","+f(t[1])+")"})).style("cursor","pointer").attr("width",i).style("stroke","#fff").attr("height",(function(t,e){return f(t[0])-f(t[1])})).style("fill",(function(t){return b(t.key)}))}),(function(t){return t}),(function(t){return t.remove()}));var y=1*e.chartHeight,_=this.width,x={top:.1*y,left:.1*y,right:.1*y,bottom:.2*y};y=y-x.top-x.bottom;var w=.5*y,k=_/this.aas.length,O=S["r"]("#barPlotLegend").append("svg").attr("id","barPlotLegendSVG").attr("viewBox","0 0 ".concat(_," ").concat(y)).append("g");p=S["l"]().domain(this.aas).range([0,_]),O.selectAll(".posBarLegRect").data(this.aas).enter().append("rect").attr("transform",(function(t){return"translate("+p(t)+",0)"})).attr("height",w).attr("width",k).style("fill",(function(t){return b(t)}));var D=S["a"](p).ticks(20).tickSizeOuter(0).tickSize(0);O.append("g").attr("class","xAxis").attr("id","xAxisRBar").attr("transform","translate(0,"+w+")").style("fill",null).style("stroke-width",.2).call(D).call((function(t){return t.select(".domain").remove()})).selectAll("text").style("text-anchor","middle").attr("transform","rotate(0)").style("font-size","17px");try{var H=S["h"](g.selectAll("g").nodes().map((function(t){return t.getBBox().height})));if(H>i&&g.style("font-size","".concat(i/H,"em")),H=S["h"](d.selectAll("g").nodes().map((function(t){return t.getBBox().height}))),H>this.margin.bottom){var C=this.margin.bottom;d.style("font-size","".concat(C/H,"em"))}}catch(A){console.error(A)}}}},{key:"mounted",value:function(){this.width=this.$refs.barPlotDiv.clientWidth,this.margin.right=.05*this.width,this.margin.left=.1*this.width,this.makeBarPlot()}}]),a}(u["c"]);Object(c["a"])([Object(u["b"])({required:!0})],ut.prototype,"DataHandler",void 0),Object(c["a"])([Object(u["d"])("DataHandler.selectedPosition",{deep:!0})],ut.prototype,"onDataHandlerChanged",null),ut=Object(c["a"])([Object(u["a"])({})],ut);var pt=ut,ht=pt,dt=Object(g["a"])(ht,lt,ct,!1,null,null,null),ft=dt.exports,mt=function(t){Object(o["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(s["a"])(this,a),t=e.apply(this,arguments),t.depth_threshold=0,t.frequency_threshold=.2,t.column_width=9,t.pdb=null,t.position=54,t.cells=null,t.group=[],t.customfile=null,t.referenceSequence=[],t.localDataHelper=new A,t.switchedViewer=!0,t.DataHandler=new L,t.amino_acid_label_option="None",t.axis_label_option="None",t}return Object(k["a"])(a,[{key:"sliderUpdate",value:function(t){var e=t.target,a=t.value;this.$set(this,e,a),"DataHandler"==e&&(this.pdb=a.pdb,this.$refs.heatmap&&(this.$refs.heatmap.changeDataHandler(),this.$refs.barplot.changeDataHandler()))}},{key:"siteHover",value:function(t){t.focus?this.$refs.heatmap.focusColumn(t.position,!0):this.$refs.heatmap.unfocusColumn(t.position)}},{key:"changePosition",value:function(t){this.position=t}},{key:"changeReferenceSequence",value:function(t){this.DataHandler.updateReference(t),this.DataHandler.updateCells(),this.sliderUpdate({target:"DataHandler",value:this.DataHandler})}},{key:"changePdb",value:function(t){this.pdb=t}}]),a}(u["c"]);mt=Object(c["a"])([Object(u["a"])({components:{Heatmap:F,VisualizationOptions:E,MoleculeViewer:ot,BarPlot:ft}})],mt);var gt=mt,bt=gt,vt=(a("9f6b"),Object(g["a"])(bt,x,w,!1,null,"1a5de08e",null)),yt=vt.exports,_t=function(t){Object(o["a"])(a,t);var e=Object(l["a"])(a);function a(){return Object(s["a"])(this,a),e.apply(this,arguments)}return a}(u["c"]);_t=Object(c["a"])([Object(u["a"])({components:{Visualization:yt}})],_t);var xt=_t,wt=xt,kt=Object(g["a"])(wt,y,_,!1,null,"10972031",null),Ot=kt.exports,Dt=(a("f9e3"),a("2dd8"),function(t){Object(o["a"])(a,t);var e=Object(l["a"])(a);function a(){return Object(s["a"])(this,a),e.apply(this,arguments)}return a}(u["c"]));Dt=Object(c["a"])([Object(u["a"])({components:{NavigationBar:v,DataView:Ot}})],Dt);var Ht=Dt,jt=Ht,Ct=(a("58c9"),Object(g["a"])(jt,i,r,!1,null,"50556d82",null)),St=Ct.exports,At=a("8c4f"),Pt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[t._v(" Lorem ipsem... ")])},Lt=[],Rt=function(t){Object(o["a"])(a,t);var e=Object(l["a"])(a);function a(){return Object(s["a"])(this,a),e.apply(this,arguments)}return a}(u["c"]);Rt=Object(c["a"])([Object(u["a"])({})],Rt);var Bt=Rt,qt=Bt,Mt=Object(g["a"])(qt,Pt,Lt,!1,null,"5b1b9234",null),Et=Mt.exports;n["default"].use(At["a"]);var Gt=[{path:"/",name:"Data",component:Ot},{path:"/about",name:"About",component:Et}],Vt=new At["a"]({mode:"history",routes:Gt,base:"/BARDA"}),$t=Vt,zt=a("289d"),Tt=(a("5363"),a("5f5b")),It=a("5886");a("4413");a("bb35"),n["default"].use(zt["a"]),n["default"].use(Tt["a"]),n["default"].use(It["a"]),n["default"].config.productionTip=!1,new n["default"]({router:$t,render:function(t){return t(St)}}).$mount("#app")},d698:function(t,e,a){"use strict";a("0409")},e91a:function(t,e,a){"use strict";a("8ca8")}});
//# sourceMappingURL=app.4223aea6.js.map